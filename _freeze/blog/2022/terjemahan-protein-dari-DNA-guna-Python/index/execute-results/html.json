{
  "hash": "d9278f6b79fc3a0a87d20e16f1ce444d",
  "result": {
    "markdown": "---\ndraft: true\ntitle: \"Kaedah Menghasilkan Protein Dari Sejujuk DNA Guna Python\"\nsubtitle: \"Aku cuba teroka bioinformatik asas bersama kawan aku yang cuba belajar Python\"\ndate: \"2022-02-25\"\ncategories: [\"pengaturcaraan Python\"]\nimages: [\"DNA_1920_1080.jpg\"]\nauthors: [\"Murthadza Aznam\"]\njupyer: python3\nfreeze: true\n---\n\n<!-- TODO: Make interactive -->\n\nAku bukanlah orang dalam bidang biologi, tapi aku rasa elok kalau aku kongsikan apa yang aku sudah belajar.\nPada pertengahan tahun lepas, aku ada ajar seorang kawan aku pengaturcaraan Python.\nMemandangkan dia adalah orang dari bidang biologi, kita sama-sama belajar menterjemah DNA menjadi protein berdasarkan [siri tutorial yang telah disediakan oleh saluran YouTube RebelCoder](https://www.youtube.com/playlist?list=PLpSOMAcxEB_jUKMvdl8rHqNiZXFIrtd5G).\n\n## Dogma Pusat Biologi Molekul\n\nDogma pusat ialah satu set penjelasan aliran maklumat genetik dalam sistem biologi.\nSalah satunya ialah aliran bagaimana DNA boleh menghasilkan rantaian protein yang membentuk kehidupan.\nSecara ringkasnya, DNA menghasilkan RNA melalui proses transkripsi kemudian RNA akan menghasilkan protein melalui proses penterjemahan.\n\nWalaupun dogma pusat mengatakan protein dihasilkan daripada RNA, kita boleh langkau langkah ini kerana bentuk RNA sama sahaja seperti DNA kecuali bes timina (T) DNA diganti dengan bes urasil (U) RNA.\nOleh itu, pengabaian langkah ini tidak akan menjejaskan hasil akhir protein bagi tujuan kita.\n\nRumusan dogma pusat boleh didapati dalam video ini oleh Coretan Biologi:\n\n{{< video https://www.youtube.com/embed/mTHzTsgpiSc />}}\n\n## Pertama: Sediakan Pasangan Pemadanan\n\nSetiap asid amino dalam protein merupakah hasil bacaan satu set tiga bes serangkai yang dinamakan kodon.\nOleh itu, kita perlu beritahu kod kita kodon apa akan hasilkan asid apa.\nKita sediakan satu `dict` dengan nilai berikut:\n\n::: {.cell execution_count=1}\n``` {.python .cell-code caption=\"structures.py\"}\nDNA_Codons_Mapping: dict = {\n    \"GCT\": \"A\", \"GCC\": \"A\", \"GCA\": \"A\", \"GCG\": \"A\",\n    \"TGT\": \"C\", \"TGC\": \"C\",\n    \"GAT\": \"D\", \"GAC\": \"D\",\n    \"GAA\": \"E\", \"GAG\": \"E\",\n    \"TTT\": \"F\", \"TTC\": \"F\",\n    \"GGT\": \"G\", \"GGC\": \"G\", \"GGA\": \"G\", \"GGG\": \"G\",\n    \"CAT\": \"H\", \"CAC\": \"H\",\n    \"ATA\": \"I\", \"ATT\": \"I\", \"ATC\": \"I\",\n    \"AAA\": \"K\", \"AAG\": \"K\",\n    \"TTA\": \"L\", \"TTG\": \"L\", \"CTT\": \"L\", \"CTC\": \"L\", \"CTA\": \"L\", \"CTG\": \"L\",\n    \"ATG\": \"M\", # Kodon pemula\n    \"AAT\": \"N\", \"AAC\": \"N\",\n    \"CCT\": \"P\", \"CCC\": \"P\", \"CCA\": \"P\", \"CCG\": \"P\",\n    \"CAA\": \"Q\", \"CAG\": \"Q\",\n    \"CGT\": \"R\", \"CGC\": \"R\", \"CGA\": \"R\", \"CGG\": \"R\", \"AGA\": \"R\", \"AGG\": \"R\",\n    \"TCT\": \"S\", \"TCC\": \"S\", \"TCA\": \"S\", \"TCG\": \"S\", \"AGT\": \"S\", \"AGC\": \"S\",\n    \"ACT\": \"T\", \"ACC\": \"T\", \"ACA\": \"T\", \"ACG\": \"T\",\n    \"GTT\": \"V\", \"GTC\": \"V\", \"GTA\": \"V\", \"GTG\": \"V\",\n    \"TGG\": \"W\",\n    \"TAT\": \"Y\", \"TAC\": \"Y\",\n    \"TAA\": \"_\", \"TAG\": \"_\", \"TGA\": \"_\" # Kodon berhenti\n}\n```\n:::\n\n\nPemetaan ini memberitahu kita bahawa jujukan bes `\"GCT\"` akan menghasilkan asid `A` dan seterusnya.\nSetiap asid diwakili oleh satu huruf yang merujuk kepada huruf pertama nama asid tersebut.\nKodon yang berbeza boleh menghasilkan asid yang sama.\n\nPerlulah kita ketahui akan dua huruf penting yang aku nyalakan dalam kod di atas.\nHuruf pertama ialah huruf `M` yang merujuk kepada asid metionina yang dihasilkan oleh kodon `\"ATG\"`.\nKodon ini dinamakan \"kodon pemula\" kerana ia mengisytiharkan permulaan rantaian asid amino.\n\nHuruf kedua pula ialah huruf `_` yang dihasilkan oleh tiga kodon berbeza.\nKodon-kodon ini pula merupakan \"kodon berhenti\": ia memberitahu agar pembinaan rantaian asid perlu berhenti.\nIa tidak mewakili apa-apa asid, maka simbol `_` dipilih.\n\nSecara ringkasnya, rantaian asid amino tidak akan dihasilkan selagi mana kodon pemula tidak dijumpai.\nKemudian, rantaian itu akan diputuskan ketika bertemu dengan kodon berhenti.\nHasil rantaian itulah protein makhluk tersebut.\n\n## Sampingan: Pengesahan Jujukan DNA\n\nLangkah ini bukanlah satu kewajipan, tatepi ia bantu melancarkan algoritma kita supaya kita tak masukkan input yang tak sah.\nKita gunakan langkah ini untuk memastikan jujukan huruf yang dimasukkan itu adalah jujukan DNA yang sah.\nBila dah melalui pengesahan ini, kita boleh yakin yang tidak ada set huruf yang pelik seperti `ABC` yang akan mengeluarkan ralat kerana tiada padanan langsung.\n\nUntuk pastikan jujukan kita hanya mempunyai huruf-huruf yang dibenarkan sahaja, kita boleh siapkan satu `tuple` bes-bes DNA dan semak keahlian huruf-huruf dalam jujukan input.\nKita guna `tuple` dan bukan `list` sebab kita nak elakkan kesilapan penambahan huruf yang tidak disengajakan.\nDisebabkan `tuple` tidak membenarkan penambahan ahli, maka ia adalah calon yang baik.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code caption=\"structures.py\"}\nDNA_Bases: tuple = (\"A\", \"C\", \"G\", \"T\")\n```\n:::\n\n\nKemudian, kita sediakan fungsi `validate_sequence()` yang akan memunculkan ralat sekiranya inputnya tidak sah.\nPerkara sedekimian boleh dicapai dengan mengambil setiap huruf dalam `dna_seq` dan `raise ValueError` sekiranya huruf tersebut tiada dalam `tuple` yang disediakan.\nSekiranya, ia bertemu dengan huruf yang tidak sah, `raise ValueError` akan menghentikan program.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code caption=\"DNA_to_proteins.py\"}\n# from structures import DNA_Bases\n\ndef validate_sequence(dna_seq: str) -> str:\n    \"\"\"Semak sama ada input adalah jujukan DNA adalah sah\"\"\"\n    check_seq = dna_seq.upper()\n    for nuc in check_seq:\n        if nuc not in DNA_Bases:\n            raise ValueError(f\"Jujukan tidak sah. `{nuc}` bukan ahli {DNA_Bases=}\")\n    return check_seq\n```\n:::\n\n\n## Kedua: Proses Terjemahan\n\nSekarang ini, kita perlu beritahu komputer supaya dapatkan tiga bes serangkai, pastu padankan dengan asid menggunakan pemetaan `DNA_Codons_Mapping` yang kita dah sediakan sebelum ini.\nNamun begitu, perlu ditegaskan bahawa pembacaan huruf tidak semestinya bermula dari huruf pertama.\nMisalnya, katalah kita ada jujukan `ABCDEF`, pembacaan boleh mula dari `A`, `B`, `C`, `D` atau seterusnya.\nOleh itu, kita sediakan satu pembolehubah kedudukan awal `init_pos` dengan nilai asal `0` yang kita boleh tentukan kemudian.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code caption=\"DNA_to_proteins.py\"}\n# from structures import DNA_Codons_Mapping\n\ndef make_translation(dna_seq: str, init_pos: int = 0) -> list:\n    \"\"\"Menterjemahkan jujukan input menjadi senarai asid amino\"\"\"\n    acids = list()\n    # Lelaran akan melangkau setiap tiga huruf sebab itulah panjang satu kodon\n    for pos in range(init_pos, len(dna_seq) - 2, 3):\n        codon = dna_seq[pos:pos + 3]\n        acids.append(DNA_Codons_Mapping[codon])\n    return acids\n```\n:::\n\n\nFungsi ini akan memulangkan senarai asid kerana memang itulah yang kita mahukan.\n\n## Ketiga: Semua Kemungkinan Senarai Asid\n\nUntuk setiap jujukan DNA, ada enam kemungkinan senarai asid yang boleh dihasilkan.\nHal ini kerana setiap kodon boleh mula dibaca dari mana-mana tiga huruf dalam jujukan tersebut.\nPerkara ini menghasilkan 3 kemungkinan.\nTambahan pula, jujukan DNA tersebut ada pasangannya, maka pasangannya juga akan menghasilkan 3 kemungkinan senarai asidnya yang tersendiri.\nMaka, jumlahnya ialah 6 kemungkinan.\n\nNampaknya bacaan kodon yang berbeza permulaannya dipanggil \"[rangka bacaan](https://www.ncbi.nlm.nih.gov/Class/MLACourse/Original8Hour/Genetics/readingframe.html)\".\n\n<Example>\n    \nKatakan ada jujukan DNA `GATTAGCCAGATTAC`, boleh jadi kodonnya adalah begini:\n1. [GAT][TAG][CCA][GAT][TAC] &larr; Jujukan input\n2. G[ATT][AGC][CAG][ATT]AC\n3. GA[TTA][GCC][AGA][TTA]C\n4. [CTA][ATC][GGT][CTA][ATG] &larr; Jujukan pasangan\n5. C[TAA][TCG][GTC][TAA]TG\n6. CT[AAT][CGG][TCT][AAT]G\n\n</Example>\n\nApa yang kita perlu buat ialah panggil fungsi yang sama berulang kali dengan `init_pos` yang berbeza.\nSelain itu, kita juga perlu ada satu fungsi yang akan hasilkan pasangan jujukan input.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code caption=\"DNA_to_proteins.py\"}\nfrom typing import List # Membolehkan kita nyatakan jenis isi dalam `List`\n\ndef make_complement(dna_seq: str) -> str:\n    \"\"\"Menghasilkan pasangan jujukan yang melekat bersama dengan jujukan input\"\"\"\n    mapping = str.maketrans('ATGC', 'TACG')\n    return dna_seq.translate(mapping)\n\ndef make_reverse_complement(dna_seq: str) -> str:\n    \"\"\"Menterbalikkan pasangan jujukan (sebab pasangannya dibaca berlawanan arah)\"\"\"\n    return make_complement(dna_seq)[::-1]\n\ndef make_reading_frames(dna_seq: str) -> List[List[str]]:\n    \"\"\"Menghasilkan kesemua enam (6) rangka bacaan daripada jujukan bes DNA yang diberikan.\"\"\"\n    frames = []\n    frames.append(make_translation(dna_seq, 0))\n    frames.append(make_translation(dna_seq, 1))\n    frames.append(make_translation(dna_seq, 2))\n    frames.append(make_translation(make_reverse_complement(dna_seq), 0))\n    frames.append(make_translation(make_reverse_complement(dna_seq), 1))\n    frames.append(make_translation(make_reverse_complement(dna_seq), 2))\n    return frames\n```\n:::\n\n\n## Keempat: Mencari Kodon Mula dan Kodon berhenti\n\nKita perlu sediakan arahan supaya:\n\n1. Jika ia adalah kodon berhenti, `_`, maka hentikan rantaian jika wujud.\n2. Jika ia adalah asid dari kodon mula, `M`, maka mulakan rantaian.\n3. Jika ia adalah asid biasa, maka sambung rantaian jika wujud ataupun langkau jika tiada rantaian.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code caption=\"DNA_to_proteins.py\"}\ndef make_proteins_from_one_reading_frame(amino_acid_seq: list) -> list:\n    \"\"\"Menghasilkan calon protein dengan mengenal pasti kodon pemula dan kodon berhenti\"\"\"\n    current_protein = []\n    proteins = []\n    for amino_acid in amino_acid_seq:\n        if amino_acid == \"_\":\n            # Hentikan rantain\n            if current_protein:\n                # Dapatkan rantaian jika wujud\n                for p in current_protein:\n                    proteins.append(p)\n                current_protein = []\n        else:\n            if amino_acid == \"M\":\n                # Mulakan rantaian\n                current_protein.append(\"\")\n            for i in range(len(current_protein)):\n                # Operasi ini tidak akan buat apa-apa kalau tiada `\"\"` yang dihasilkan oleh syarat sebelum ini\n                current_protein[i] += amino_acid\n    return proteins\n```\n:::\n\n\nKemudian, kita boleh dapatkan semua protein yang mungkin dihasilkan oleh jujukan DNA serta pasangannya.\n\n::: {.cell execution_count=7}\n``` {.python .cell-code caption=\"DNA_to_proteins.py\"}\ndef make_proteins_from_all_reading_frames(dna_seq: str, ordered=False) -> List[str]:\n    \"\"\"Menghasilkan calon protein daripada semua rangka bacaan yang dihasilkan dari sejujuk DNA\"\"\"\n    frames = make_reading_frames(dna_seq)\n\n    potential_proteins = []\n    for frame in frames:\n        proteins = make_proteins_from_one_reading_frame(frame)\n        for p in proteins:\n            potential_proteins.append(p)\n\n    # Susun supaya yang paling panjang berada di atas\n    if ordered:\n        potential_proteins = sorted(potential_proteins, key=len, reverse=True)\n\n    return potential_proteins\n```\n:::\n\n\n## Penentusahan\n\nSemestinya, kalau kita ada model, kita perlu tentusahkannya sama ada ia berfungsi atau tidak.\nKita boleh lakukan sedemikian dengan cuba memadankannya dengan pangkalan data yang diketahui.\nSatu contoh pangkalan data yang boleh cuba digunakan ialah pangkalan data _National Center for Biotechnology Information_ (NCBI).\n\nKita ambil satu contoh data insulin homo sapiens [`NM_001185097.2`](https://www.ncbi.nlm.nih.gov/nuccore/NM_001185097.2) (Pergi ke pautan FASTA untuk dapatkan jujukan DNAnya).\nAlgoritma aku menghasilkan senarai ini:\n\n\n```{bash}\nMALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAEDLQVGQVELGGGPGAGSLQPLALEGSLQKRGIVEQCCTSICSLYQLENYCN\nMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAEDLQVGQVELGGGPGAGSLQPLALEGSLQKRGIVEQCCTSICSLYQLENYCN\nMLVQHCSTMPRFCRDPSRAKGCRLPAPGPPPSSTCPTCRSSASRRVLGV\nMPRFCRDPSRAKGCRLPAPGPPPSSTCPTCRSSASRRVLGV\nMAEGQ\nME\n```\n\n\nKalau dibandingkan dengan maklumat `\\translation` yang ada pada pautan tersebut, ternyata ia padan dengan rantaian pertama hasil algoritma aku.\nCubalah buat sendiri dan cuba padankannya dengan data lain.\nKod-kod yang ditulis ada disediakan dalam [repositori GitHub](https://github.com/Thaza-Kun/Algoritma-Terjemahan-Protein/tree/arkib).\nBolehlah gunakannya sebagai rujukan.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}